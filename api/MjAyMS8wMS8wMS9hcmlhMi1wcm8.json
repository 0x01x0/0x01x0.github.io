{"title":"Docker安装以及运行Aria2整合教程","date":"2020-12-31T17:41:43.000Z","date_formatted":{"ll":"Jan 1, 2021","L":"01/01/2021","MM-DD":"01-01"},"link":"2021/01/01/aria2-pro","updated":"2021-01-06T17:42:23.624Z","content":"<h2 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h2>\n<p>本文只是做为杜绝重装系统后翻天覆地找教程而做，顺道做一个小分享。如果有人喜欢，尽管拿去。不用谢谢我，我也只是做了一个整合而已。<br>\n废话不多说，现在就开始我们今天的表演。</p>\n<h2 id=\"安装docker\">安装Docker<a title=\"#安装docker\" href=\"#安装docker\"></a></h2>\n<p>这里我必须夸奖一下<a href=\"https://mirrors.tuna.tsinghua.edu.cn/\" target=\"_blank\">清华大学开源软件镜像站</a>，教程通俗易懂，简直是一站式的体验，操作完后无需手动更换国内源，<code>懒鬼</code>的福音。</p>\n<h3 id=\"debian/ubuntu-用户\">Debian/Ubuntu 用户<a title=\"#debian/ubuntu-用户\" href=\"#debian/ubuntu-用户\"></a></h3>\n<p>如果你过去安装过Docker，先输入以下命令卸载:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get remove docker docker-engine docker.io</span><br></pre></td></tr></table></figure>\n<p>首先安装依赖:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install apt-transport-https ca-certificates curl gnupg2 software-properties-common</span><br></pre></td></tr></table></figure>\n<p><b>请注意你的发行版，切勿用Debian的源安装在Ubuntu的系统上。</b></p>\n<h3 id=\"信任-docker-的-gpg-公钥:\">信任 Docker 的 GPG 公钥:<a title=\"#信任-docker-的-gpg-公钥:\" href=\"#信任-docker-的-gpg-公钥:\"></a></h3>\n<h4 id=\"该命令适用于ubuntu\">该命令适用于Ubuntu<a title=\"#该命令适用于ubuntu\" href=\"#该命令适用于ubuntu\"></a></h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -fsSL https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;ubuntu&#x2F;gpg | sudo apt-key add - </span><br></pre></td></tr></table></figure>\n<h4 id=\"该命令适用于debian\">该命令适用于Debian<a title=\"#该命令适用于debian\" href=\"#该命令适用于debian\"></a></h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -fsSL https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;debian&#x2F;gpg | sudo apt-key add -</span><br></pre></td></tr></table></figure>\n<p>对于<code>amd64架构</code>的计算机，添加软件仓库:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo add-apt-repository \\</span><br><span class=\"line\">   &quot;deb [arch&#x3D;amd64] https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;docker-ce&#x2F;linux&#x2F;ubuntu \\</span><br><span class=\"line\">   $(lsb_release -cs) \\</span><br><span class=\"line\">   stable&quot;</span><br></pre></td></tr></table></figure>\n<p>如果你是<code>树莓派或其它ARM架构</code>计算机，请运行:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;deb [arch&#x3D;armhf] https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;docker-ce&#x2F;linux&#x2F;ubuntu \\</span><br><span class=\"line\">     $(lsb_release -cs) stable&quot; | \\</span><br><span class=\"line\">    sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;docker.list</span><br></pre></td></tr></table></figure>\n<p>最后输入：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install docker-ce</span><br></pre></td></tr></table></figure>\n<p>到此，Debian/Ubuntu用户的Docker就安装好了。</p>\n<h3 id=\"fedora/centos/rhel-用户\">Fedora/CentOS/RHEL 用户<a title=\"#fedora/centos/rhel-用户\" href=\"#fedora/centos/rhel-用户\"></a></h3>\n<p>如果你之前安装过Docker，先输入以下命令卸载:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum remove docker docker-common docker-selinux docker-engine</span><br></pre></td></tr></table></figure>\n<p><b>请注意你的发行版，切勿用Fedora的源安装在CentOS/RHEL的系统上。</b></p>\n<h4 id=\"该命令适用于fedora\">该命令适用于Fedora<a title=\"#该命令适用于fedora\" href=\"#该命令适用于fedora\"></a></h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;docker-ce.repo https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;fedora&#x2F;docker-ce.repo</span><br></pre></td></tr></table></figure>\n<h4 id=\"该命令适用于centos/rhel\">该命令适用于CentOS/RHEL<a title=\"#该命令适用于centos/rhel\" href=\"#该命令适用于centos/rhel\"></a></h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;docker-ce.repo https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;centos&#x2F;docker-ce.repo</span><br></pre></td></tr></table></figure>\n<p>把软件仓库地址替换为TUNA（清华源的缩写）:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo sed -i &#39;s+download.docker.com+mirrors.tuna.tsinghua.edu.cn&#x2F;docker-ce+&#39; &#x2F;etc&#x2F;yum.repos.d&#x2F;docker-ce.repo</span><br></pre></td></tr></table></figure>\n<p>最后输入：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum makecache fast</span><br><span class=\"line\">sudo yum install docker-ce</span><br></pre></td></tr></table></figure>\n<p>到此，Fedora/CentOS/RHEL用户的Docker就安装好了。</p>\n<h2 id=\"aria2\">Aria2<a title=\"#aria2\" href=\"#aria2\"></a></h2>\n<p>Aria2是一个功能非常强大且功能非常齐全的下载工具，它支持 BT、磁力、HTTP、FTP 等下载协议，常用做离线下载的服务端。这里首先要感谢<a href=\"https://p3terx.com/\" target=\"_blank\">P3TERX</a>制造出来只需要简单设置，就相当好用的Aria2-pro的Docker镜像。这里我就讲一些基础，想进阶的同学可以移步到<a href=\"https://p3terx.com/archives/docker-aria2-pro.html\" target=\"_blank\">P3TERX的教程</a>修炼更高阶的玩法。</p>\n<h3 id=\"拉取并运行aria2-pro镜像\">拉取并运行Aria2-pro镜像<a title=\"#拉取并运行aria2-pro镜像\" href=\"#拉取并运行aria2-pro镜像\"></a></h3>\n<p>在终端输入以下命令拉取并运行<a href=\"https://hub.docker.com/r/p3terx/aria2-pro\" target=\"_blank\">P3TERX制作的Docker镜像</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">    --name aria2-pro \\ #容器名称</span><br><span class=\"line\">    --restart unless-stopped \\ #容器重启策略</span><br><span class=\"line\">    --log-opt max-size&#x3D;1m \\ #日志大小限制为 1MB</span><br><span class=\"line\">    -e PUID&#x3D;$UID \\ #设置容器内账户UID</span><br><span class=\"line\">    -e PGID&#x3D;$GID \\ #设置容器内账户GID</span><br><span class=\"line\">    -e RPC_SECRET&#x3D;&lt;TOKEN&gt; \\ #RPC秘钥，注意替换&lt;TOKEN&gt;字段</span><br><span class=\"line\">    -p 6800:6800 \\ #RPC 通讯端口映射</span><br><span class=\"line\">    -p 6888:6888 \\ #BT 监听端口（TCP）</span><br><span class=\"line\">    -p 6888:6888&#x2F;udp \\ # DHT 监听端口（UDP）</span><br><span class=\"line\">    -v ~&#x2F;aria2-config:&#x2F;config \\ #配置目录映射</span><br><span class=\"line\">    -v ~&#x2F;downloads:&#x2F;downloads \\ #下载目录映射</span><br><span class=\"line\">    p3terx&#x2F;aria2-pro #镜像名称</span><br></pre></td></tr></table></figure>\n<p><b>RPC秘钥：即We­bUI连接时需要填写的密码。<code>使用启动命令定义后无法进行修改，只能删除容器重建</code>。</b></p>\n<p><b>目录映射：冒号的左边为主机上的目录，右边为容器的目录，只能更换左边目录到你的指定目录，右边千万不能更改，且目录<code>不能包含中文</code>。</b></p>\n<h3 id=\"使用ariang连接aria2-pro\">使用AriaNg连接Aria2-pro<a title=\"#使用ariang连接aria2-pro\" href=\"#使用ariang连接aria2-pro\"></a></h3>\n<p>Aria2-pro只是服务，并没有GUI界面，我们需要使用AriaNg来连接，这里又要感谢一遍<a href=\"http://p3terx.gitee.io/ariang\" target=\"_blank\">P3TERX提供的WebUI</a>，打开网页，点击左边菜单栏上的AriaNg设置，再点击右边的RPC，然后在Aria2 RPC地址里输入你刚刚安装Aria2-pro的设备IP，在Aria2 RPC秘钥里输入创建的秘钥，右上角会弹出一个框，点击重新加载AriaNg，左边菜单栏下出现绿色的已连接，那么就可以开始你的下载了。</p>\n<h2 id=\"总结\">总结<a title=\"#总结\" href=\"#总结\"></a></h2>\n<p>本文有比较多挺容易踩坑的地方，如果出现报错或者运行失败的地方，<b>请<code>认真</code>、<code>仔细</code>看我标注的重点</b>。</p>\n<h2 id=\"最后的最后\">最后的最后<a title=\"#最后的最后\" href=\"#最后的最后\"></a></h2>\n<p>这篇文章算是我写的非常难受的一篇文章了，如果只是复制粘贴，我相信大部分人已经成功的运行了，但是为了发挥一篇整合教程的作用，我必须更换成一些浅显易懂的词语句子~，让我很费脑~。不过好在算是写完了，这里还是要再次感谢<a href=\"https://mirrors.tuna.tsinghua.edu.cn/\" target=\"_blank\">清华大学开源软件镜像站</a>和<a href=\"https://p3terx.com/\" target=\"_blank\">优秀的P3TERX</a>，毕竟没有他们也就没有这篇简陋的教程。</p>\n<h2 id=\"参考\">参考<a title=\"#参考\" href=\"#参考\"></a></h2>\n<p>P3TERX：<a href=\"https://p3terx.com/archives/docker-aria2-pro.html\">https://p3terx.com/archives/docker-aria2-pro.html</a><br>\n清华源：<a href=\"https://mirrors.tuna.tsinghua.edu.cn/help/docker-ce/\">https://mirrors.tuna.tsinghua.edu.cn/help/docker-ce/</a></p>\n","prev":{"title":"Aria2-Pro for Docker","link":"2021/01/01/aria2-docker"},"next":{"title":"利用Python批量把图片输出为PDF文档","link":"2021/01/01/pillow"},"plink":"http://example.com/2021/01/01/aria2-pro/","toc":[{"id":"前言","title":"前言","index":"1"},{"id":"安装docker","title":"安装Docker","index":"2","children":[{"id":"debian/ubuntu-用户","title":"Debian&#x2F;Ubuntu 用户","index":"2.1"},{"id":"信任-docker-的-gpg-公钥:","title":"信任 Docker 的 GPG 公钥:","index":"2.2"},{"id":"fedora/centos/rhel-用户","title":"Fedora&#x2F;CentOS&#x2F;RHEL 用户","index":"2.3"}]},{"id":"aria2","title":"Aria2","index":"3","children":[{"id":"拉取并运行aria2-pro镜像","title":"拉取并运行Aria2-pro镜像","index":"3.1"},{"id":"使用ariang连接aria2-pro","title":"使用AriaNg连接Aria2-pro","index":"3.2"}]},{"id":"总结","title":"总结","index":"4"},{"id":"最后的最后","title":"最后的最后","index":"5"},{"id":"参考","title":"参考","index":"6"}]}