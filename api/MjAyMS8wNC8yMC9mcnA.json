{"title":"使用FRP达到内网穿透","date":"2021-04-20T15:06:24.000Z","date_formatted":{"ll":"Apr 20, 2021","L":"04/20/2021","MM-DD":"04-20"},"link":"2021/04/20/frp","updated":"2021-04-20T15:33:51.289Z","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><h1 id=\"配置frp服务端\">配置FRP服务端<a title=\"#配置frp服务端\" href=\"#配置frp服务端\"></a></h1>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https:&#x2F;&#x2F;github.com&#x2F;fatedier&#x2F;frp&#x2F;releases&#x2F;download&#x2F;v0.36.2&#x2F;frp_0.36.2_linux_amd64.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">tar -xzvf frp*</span><br><span class=\"line\"></span><br><span class=\"line\">mv frp_0.36.2_linux_amd64 frp</span><br><span class=\"line\"></span><br><span class=\"line\">cd frp</span><br><span class=\"line\"></span><br><span class=\"line\">vim frps.ini</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>添加一行配置</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">token &#x3D; xxxxxxxx</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>:wq</code>保存退出.</p>\n<ul>\n<li>xxxxxxxx是你的连接密钥,后面使用客户端连接的时候需要用到</li>\n</ul>\n<h1 id=\"测试\">测试<a title=\"#测试\" href=\"#测试\"></a></h1>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.&#x2F;frps -c frps.ini</span><br></pre></td></tr></table></figure>\n<p>出现下面这些东西,就说明启动成功了.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2021&#x2F;04&#x2F;20 21:55:23 [I] [root.go:200] frps uses config file: frps.ini                                                                                                                                                                        </span><br><span class=\"line\">2021&#x2F;04&#x2F;20 21:55:23 [I] [service.go:192] frps tcp listen on 0.0.0.0:7000                                                                                                                                                                     </span><br><span class=\"line\">2021&#x2F;04&#x2F;20 21:55:23 [I] [root.go:209] frps started successfully                                                                                                                                                                              </span><br></pre></td></tr></table></figure>\n<h1 id=\"创建服务项\">创建服务项<a title=\"#创建服务项\" href=\"#创建服务项\"></a></h1>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;frps.service</span><br></pre></td></tr></table></figure>\n<p>编辑文本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description&#x3D;fraps service</span><br><span class=\"line\">After&#x3D;network.target syslog.target</span><br><span class=\"line\">Wants&#x3D;network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Type&#x3D;simple</span><br><span class=\"line\">ExecStart&#x3D;&#x2F;root&#x2F;frp&#x2F;frps -c &#x2F;root&#x2F;frp&#x2F;frps.ini</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure>\n<p>启动FRPS <code>systemctl start frps </code></p>\n<p>设置开机自动启动 <code>systemctl enable frps</code></p>\n<p>重启系统以后,可以输入<code>ps auxw</code>查看FRPS是否成功启动.</p>\n<h1 id=\"设置frp客户端\">设置FRP客户端<a title=\"#设置frp客户端\" href=\"#设置frp客户端\"></a></h1>\n<p>在<code>OpenWRT</code>系统上安装FRP客户端</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https:&#x2F;&#x2F;skychat.cf&#x2F;api&#x2F;v4&#x2F;files&#x2F;wxc56jww6bn17k6terpapuu5dc?download&#x3D;1</span><br><span class=\"line\"></span><br><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\">opkg install frpc*</span><br></pre></td></tr></table></figure>\n<p>刷新OpenWRT管理页面,在服务列表里可以看到FRP Setting</p>\n<ul>\n<li>\n<p>服务器里填上服务端的IP地址</p>\n</li>\n<li>\n<p>端口填写默认7000</p>\n</li>\n<li>\n<p>Token就是你前面自己设定的token</p>\n</li>\n</ul>\n<p>下面Services List里点击添加</p>\n<ul>\n<li>\n<p>Enable State设置被启用</p>\n</li>\n<li>\n<p>Frp Protocol Type设置为TCP</p>\n</li>\n<li>\n<p>远程节点端口自定义</p>\n</li>\n<li>\n<p>Local Host Address本地选你需要穿透出去的设备IP</p>\n</li>\n<li>\n<p>Local Host Port本地端口选你需要穿透出去的服务端口,例如:Emby=8096</p>\n</li>\n<li>\n<p>Service Remark Name设置你穿透出去的服务名称,不可重复.例如:电脑A穿透服务名字设置为1,那电脑B就不能设置为1</p>\n</li>\n</ul>\n<h1 id=\"最后\">最后<a title=\"#最后\" href=\"#最后\"></a></h1>\n<p>只要按照这个步骤,就一定可以穿透成功,至少我配置了十几个设备都没有问题.</p>\n","next":{"title":"Rocket.Chat for unRAID","link":"2021/02/02/rocketchat"},"plink":"https://0x01x0.ml/2021/04/20/frp/","toc":[{"id":"配置frp服务端","title":"配置FRP服务端","index":"1"},{"id":"测试","title":"测试","index":"2"},{"id":"创建服务项","title":"创建服务项","index":"3"},{"id":"设置frp客户端","title":"设置FRP客户端","index":"4"},{"id":"最后","title":"最后","index":"5"}]}